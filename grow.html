<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„è™›æ“¬å¯µç‰©ä¸–ç•Œ ğŸ¡ğŸŒ±ğŸ¥ğŸ ğŸ˜ºğŸ‰ (æœ‰éŸ³æ•ˆç‰ˆï¼)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: linear-gradient(to bottom, #87CEEB, #98FB98); min-height: 100vh; color: #333; }
        nav { background: #4CAF50; padding: 15px; text-align: center; }
        nav button { padding: 12px 25px; margin: 10px; background: white; color: #4CAF50; border: none; border-radius: 10px; cursor: pointer; font-size: 18px; font-weight: bold; }
        nav button:hover { background: #E8F5E9; }
        .section { display: none; padding: 30px; text-align: center; }
        .active { display: block; }
        .garden { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; margin-top: 20px; }
        .pet-box { background: rgba(255,255,255,0.9); padding: 20px; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); width: 220px; transition: transform 0.3s; }
        .pet-box:hover { transform: translateY(-10px); }
        .pet { font-size: 90px; cursor: pointer; margin: 10px; }
        .pet-name { font-weight: bold; font-size: 20px; margin: 10px 0; }
        .level { color: #FF9800; font-weight: bold; }
        .bar { height: 12px; background: #ddd; border-radius: 6px; margin: 8px 0; overflow: hidden; }
        .fill { height: 100%; border-radius: 6px; transition: width 0.5s; }
        .happy { background: #4CAF50; }
        .growth { background: #8BC34A; }
        button.action { background: #2196F3; margin: 5px; }
        button.action:hover { background: #1976D2; }
        #coins { position: fixed; top: 80px; right: 20px; background: gold; color: black; padding: 10px 20px; border-radius: 50px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        #soundToggle { position: fixed; top: 80px; left: 20px; background: #FF9800; color: white; padding: 10px 20px; border-radius: 50px; cursor: pointer; }
        #detail, #overlay { display: none; position: fixed; z-index: 100; }
        #overlay { top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
        #detail { top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 20px; max-width: 500px; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        .close-btn { background: #f44336; float: right; }
    </style>
</head>
<body onload="init()">
    <nav>
        <button onclick="showSection('store'); playSound('click')">ğŸ›’ å¯µç‰©å•†åº—</button>
        <button onclick="showSection('home'); playSound('click')">ğŸ¡ å®¶åœ’</button>
        <button onclick="showSection('park'); playSound('click')">ğŸŒ³ å…¬åœ’</button>
    </nav>
    <div id="coins">é‡‘å¹£ï¼š0</div>
    <div id="soundToggle" onclick="toggleSound()">ğŸ”Š éŸ³æ•ˆé–‹å•Ÿ</div>

    <!-- å¯µç‰©å•†åº— -->
    <div id="store" class="section">
        <h2>ğŸ›’ å¯µç‰©å•†åº—</h2>
        <p>ç”¨é‡‘å¹£è§£é–æ–°å¯µç‰©ï¼ï¼ˆæ¯éš»50é‡‘å¹£ï¼‰</p>
        <div id="shopItems"></div>
    </div>

    <!-- å®¶åœ’ -->
    <div id="home" class="section active">
        <h2>ğŸ¡ æˆ‘çš„å®¶åœ’</h2>
        <p>é»æ“Šå¯µç‰©æŸ¥çœ‹è©³ç´°è³‡è¨Šï¼Œäº’å‹•è®“å®ƒå€‘æˆé•·ï¼</p>
        <div class="garden" id="homeGarden"></div>
    </div>

    <!-- å…¬åœ’ -->
    <div id="park" class="section">
        <h2>ğŸŒ³ å…¬åœ’</h2>
        <p>å¸¶å¯µç‰©ä¾†ç©è€ï¼Œå¢åŠ å¹¸ç¦å€¼ï¼é»å®ƒå€‘ç©ï½</p>
        <div class="garden" id="parkGarden"></div>
    </div>

    <!-- è©³ç´°é¢æ¿ -->
    <div id="overlay" onclick="closeDetail()"></div>
    <div id="detail">
        <button class="close-btn" onclick="closeDetail(); playSound('click')">âœ–</button>
        <h2 id="detailName"></h2>
        <div id="detailPet" style="font-size:120px;"></div>
        <p id="detailDesc"></p>
        <p id="detailLevel"></p>
        <p id="detailStatus"></p>
        <div id="detailActions"></div>
    </div>

    <!-- éŸ³æ•ˆæª”æ¡ˆï¼ˆå…è²»å…¬é–‹è³‡æºï¼‰ -->
    <audio id="bgm" loop>
        <source src="https://cdn.freesound.org/previews/612/612544_5674468-lq.ogg" type="audio/ogg">
    </audio>
    <audio id="sfxInteract">
        <source src="https://cdn.freesound.org/previews/320/320605_5270808-lq.ogg" type="audio/ogg">
    </audio>
    <audio id="sfxUnlock">
        <source src="https://cdn.freesound.org/previews/276/276325_5123856-lq.ogg" type="audio/ogg">
    </audio>
    <audio id="sfxVictory">
        <source src="https://cdn.freesound.org/previews/657/657393_11148424-lq.ogg" type="audio/ogg">
    </audio>
    <audio id="sfxClick">
        <source src="https://cdn.freesound.org/previews/919/91926_1021545-lq.ogg" type="audio/ogg">
    </audio>

    <script>
        const petsData = {
            tree: { name: "å°æ¨¹è‹—", emoji: ["ğŸŒ±","ğŸŒ¿","ğŸŒ³","ğŸŒ²","ğŸŒ¸"], growth: 0, unlocked: true, desc: "ä¸€æ£µéœ€è¦é™½å…‰èˆ‡æ„›çš„å°æ¨¹ã€‚æ¯å¤©æ¾†æ°´ï¼Œå®ƒæœƒæ…¢æ…¢é–‹èŠ±ï¼" },
            chick: { name: "é›»å­é›", emoji: ["ğŸ¥","ğŸ¤","ğŸ“","ğŸ”"], happy: 50, unlocked: false, desc: "æ´»æ½‘çš„å°é›ï¼Œå–œæ­¡åƒæ±è¥¿å’Œç©è€ã€‚é•·å¤§å¾Œæœƒè®Šæˆå¸¥æ°£çš„å…¬é›ï¼" },
            fish: { name: "å°é‡‘é­š", emoji: ["ğŸ ","ğŸŸ","ğŸ¡","ğŸŒˆğŸŸ"], clean: 80, happy: 60, unlocked: false, desc: "å„ªé›…æ¸¸æ³³çš„å°é­šï¼Œéœ€è¦ä¹¾æ·¨çš„æ°´å’Œé£Ÿç‰©ã€‚æ»¿ç´šæœƒè®Šæˆå½©è™¹é­šï¼" },
            cat: { name: "å°è²“å’ª", emoji: ["ğŸ˜º","ğŸ˜¸","ğŸ˜»","ğŸ±"], happy: 50, unlocked: false, desc: "å‚²å¬Œåˆå¯æ„›çš„è²“å’ªï¼Œæœ€æ„›è¢«æ’«æ‘¸å’Œç©ç©å…·ã€‚" },
            dragon: { name: "ç¥é¾", emoji: ["ğŸ‰","ğŸª¸ğŸ‰","ğŸ”¥ğŸ‰"], happy: 30, unlocked: false, desc: "å‚³èªªä¸­çš„ç¥é¾ï¼åªæœ‰æœ€ç”¨å¿ƒç…§é¡§æ‰€æœ‰å¯µç‰©çš„ä¸»äººæ‰æœƒå‡ºç¾ã€‚æœƒå™´ç«ä¿è­·ä½ ï¼" }
        };

        let coins = 0;
        let lastVisit = '';
        let soundEnabled = true;
        const bgm = document.getElementById('bgm');
        bgm.volume = 0.3;  // èƒŒæ™¯éŸ³æ¨‚éŸ³é‡ä½ä¸€é»

        function init() {
            loadGame();
            dailyReward();
            renderAll();
            startAutoDecline();
            showSection('home');
            if (soundEnabled) bgm.play();
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('soundToggle').textContent = soundEnabled ? 'ğŸ”Š éŸ³æ•ˆé–‹å•Ÿ' : 'ğŸ”‡ éŸ³æ•ˆé—œé–‰';
            if (soundEnabled) bgm.play();
            else bgm.pause();
        }

        function playSound(type) {
            if (!soundEnabled) return;
            let sfxId;
            if (type === 'interact') sfxId = 'sfxInteract';
            else if (type === 'unlock') sfxId = 'sfxUnlock';
            else if (type === 'victory') sfxId = 'sfxVictory';
            else if (type === 'click') sfxId = 'sfxClick';
            const sfx = document.getElementById(sfxId);
            if (sfx) {
                sfx.currentTime = 0;
                sfx.play();
            }
        }

        function renderAll() {
            renderHome();
            renderPark();
            renderShop();
            updateCoins();
        }

        function renderHome() {
            const container = document.getElementById('homeGarden');
            container.innerHTML = '';
            Object.keys(petsData).forEach(key => {
                const pet = petsData[key];
                if (!pet.unlocked) return;
                const level = Math.floor((pet.growth || pet.happy || 0) / 10);
                const value = Math.min(100, pet.growth || pet.happy || pet.clean || 0);
                const emoji = pet.emoji[Math.min(level, pet.emoji.length - 1)];
                const box = document.createElement('div');
                box.className = 'pet-box';
                box.innerHTML = `
                    <div class="pet" onclick="openDetail('${key}'); playSound('click')">${emoji}</div>
                    <div class="pet-name">${pet.name}</div>
                    <div class="level">Lv. ${level}</div>
                    <div class="bar"><div class="fill ${pet.growth ? 'growth' : 'happy'}" style="width:${value}%"></div></div>
                    <button class="action" onclick="interact('${key}')">äº’å‹• â¤ï¸</button>
                `;
                container.appendChild(box);
            });
            checkDragonUnlock();
        }

        function renderPark() {
            const container = document.getElementById('parkGarden');
            container.innerHTML = '';
            Object.keys(petsData).filter(k => petsData[k].unlocked).forEach(key => {
                const pet = petsData[key];
                const emoji = pet.emoji[0];
                const div = document.createElement('div');
                div.className = 'pet-box';
                div.innerHTML = `<div class="pet" onclick="playInPark('${key}')">${emoji}</div><p>${pet.name}</p>`;
                container.appendChild(div);
            });
        }

        function renderShop() {
            const container = document.getElementById('shopItems');
            container.innerHTML = '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;">';
            Object.keys(petsData).forEach(key => {
                const pet = petsData[key];
                if (pet.unlocked || key === 'dragon') return;
                const item = document.createElement('div');
                item.className = 'pet-box';
                item.innerHTML = `
                    <div class="pet">${pet.emoji[0]}</div>
                    <p><strong>${pet.name}</strong></p>
                    <button ${coins >= 50 ? '' : 'disabled'} onclick="buyPet('${key}')">
                        è§£é– (50é‡‘å¹£)
                    </button>
                `;
                container.appendChild(item);
            });
            container.innerHTML += '</div>';
        }

        function interact(key) {
            const pet = petsData[key];
            const add = 10;
            if (pet.growth !== undefined) pet.growth = Math.min(100, pet.growth + add);
            if (pet.happy !== undefined) pet.happy = Math.min(100, pet.happy + add);
            if (pet.clean !== undefined) pet.clean = Math.min(100, pet.clean + 5);
            coins += 5;
            playSound('interact');
            renderAll();
            saveGame();
        }

        function playInPark(key) {
            interact(key);
            playSound('interact');
            alert(`${petsData[key].name} åœ¨å…¬åœ’ç©å¾—å¾ˆé–‹å¿ƒï¼å¹¸ç¦å€¼ +10 âœ¨`);
        }

        function buyPet(key) {
            if (coins >= 50) {
                coins -= 50;
                petsData[key].unlocked = true;
                playSound('unlock');
                renderAll();
                saveGame();
                alert(`æˆåŠŸè§£é– ${petsData[key].name}ï¼`);
            }
        }

        function openDetail(key) {
            const pet = petsData[key];
            const value = pet.growth || pet.happy || 0;
            const level = Math.floor(value / 10);
            document.getElementById('detailName').textContent = `${pet.name} (Lv. ${level})`;
            document.getElementById('detailPet').textContent = pet.emoji[Math.min(level, pet.emoji.length - 1)];
            document.getElementById('detailDesc').textContent = pet.desc;
            document.getElementById('detailLevel').textContent = `é€²åº¦ï¼š${value}/100 (æ»¿ç´š10ç´š)`;
            document.getElementById('detailStatus').textContent = pet.growth ? `æˆé•·å€¼ï¼š${pet.growth}` : `å¹¸ç¦å€¼ï¼š${pet.happy}`;
            document.getElementById('detailActions').innerHTML = `
                <button class="action" onclick="interact('${key}'); closeDetail();">äº’å‹• +10</button>
            `;
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('detail').style.display = 'block';
        }

        function closeDetail() {
            playSound('click');
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('detail').style.display = 'none';
        }

        function checkDragonUnlock() {
            const basics = ['tree','chick','fish','cat'];
            const allMax = basics.every(k => {
                const pet = petsData[k];
                const val = pet.growth || pet.happy || 0;
                return val >= 100;
            });
            if (allMax && !petsData.dragon.unlocked) {
                petsData.dragon.unlocked = true;
                playSound('victory');
                alert('ğŸ‰ æ­å–œï¼æ‰€æœ‰å¯µç‰©æ»¿ç´šï¼Œç¥é¾å‡ºç¾äº†ï¼ğŸ‰');
                renderAll();
                saveGame();
            }
        }

        function dailyReward() {
            const today = new Date().toISOString().slice(0,10);
            if (lastVisit !== today) {
                coins += 20;
                lastVisit = today;
                playSound('unlock');
                alert('æ¯æ—¥ç™»å…¥çå‹µï¼š+20é‡‘å¹£ï¼');
                saveGame();
                updateCoins();
            }
        }

        function startAutoDecline() {
            setInterval(() => {
                Object.keys(petsData).forEach(key => {
                    const pet = petsData[key];
                    if (!pet.unlocked) return;
                    if (pet.happy !== undefined) pet.happy = Math.max(0, pet.happy - 1);
                    if (pet.clean !== undefined) pet.clean = Math.max(0, pet.clean - 2);
                });
                renderAll();
                saveGame();
            }, 60000); // æ¯åˆ†é˜ä¸‹é™ä¸€é»
        }

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function updateCoins() {
            document.getElementById('coins').textContent = `é‡‘å¹£ï¼š${coins}`;
        }

        function saveGame() {
            const save = {
                coins, lastVisit,
                pets: Object.fromEntries(Object.entries(petsData).map(([k,v]) => [k, {
                    growth: v.growth, happy: v.happy, clean: v.clean, unlocked: v.unlocked
                }]))
            };
            localStorage.setItem('petWorldSave', JSON.stringify(save));
        }

        function loadGame() {
            const saved = localStorage.getItem('petWorldSave');
            if (saved) {
                const data = JSON.parse(saved);
                coins = data.coins || 0;
                lastVisit = data.lastVisit || '';
                if (data.pets) {
                    Object.keys(data.pets).forEach(k => {
                        if (petsData[k]) {
                            Object.assign(petsData[k], data.pets[k]);
                        }
                    });
                }
            }
        }
    </script>
</body>
</html>
</html>
