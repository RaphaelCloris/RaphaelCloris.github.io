<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>簡單番茄鐘 + 任務清單</title>
</head>
<body>
    <h1>番茄鐘計時器</h1>
    
    <div>
        <h2 id="timer">25:00</h2>
        <p id="status">工作時間（25分鐘）</p>
        <button id="startBtn">開始</button>
        <button id="resetBtn">重置</button>
    </div>
    
    <hr>
    
    <h2>任務清單</h2>
    <input type="text" id="taskInput" placeholder="輸入新任務，按Enter新增">
    <ul id="taskList"></ul>
    
    <script>
        // === 計時器部分 ===
        let minutes = 25;
        let seconds = 0;
        let timerInterval = null;
        let isWorking = true;  // true: 工作, false: 休息
        
        const timerDisplay = document.getElementById('timer');
        const statusDisplay = document.getElementById('status');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        
        function updateDisplay() {
            timerDisplay.textContent = `\( {minutes.toString().padStart(2, '0')}: \){seconds.toString().padStart(2, '0')}`;
        }
        
        function startTimer() {
            if (timerInterval) return;  // 已經在跑就不要重複
            
            timerInterval = setInterval(() => {
                if (seconds === 0) {
                    if (minutes === 0) {
                        // 計時結束，切換工作/休息
                        clearInterval(timerInterval);
                        timerInterval = null;
                        startBtn.textContent = '開始';
                        
                        alert(isWorking ? '工作時間結束！該休息了～' : '休息時間結束！繼續努力！');
                        
                        // 自動切換
                        isWorking = !isWorking;
                        if (isWorking) {
                            minutes = 25;
                            statusDisplay.textContent = '工作時間（25分鐘）';
                        } else {
                            minutes = 5;
                            statusDisplay.textContent = '休息時間（5分鐘）';
                        }
                        seconds = 0;
                        updateDisplay();
                    } else {
                        minutes--;
                        seconds = 59;
                    }
                } else {
                    seconds--;
                }
                updateDisplay();
            }, 1000);
            
            startBtn.textContent = '暫停';
        }
        
        function pauseTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            startBtn.textContent = '繼續';
        }
        
        function resetTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            startBtn.textContent = '開始';
            isWorking = true;
            minutes = 25;
            seconds = 0;
            statusDisplay.textContent = '工作時間（25分鐘）';
            updateDisplay();
        }
        
        startBtn.addEventListener('click', () => {
            if (timerInterval) {
                pauseTimer();
            } else {
                startTimer();
            }
        });
        
        resetBtn.addEventListener('click', resetTimer);
        
        // 初始化顯示
        updateDisplay();
        
        // === 任務清單部分 ===
        const taskInput = document.getElementById('taskInput');
        const taskList = document.getElementById('taskList');
        
        // 載入先前儲存的任務
        function loadTasks() {
            const saved = localStorage.getItem('tasks');
            if (saved) {
                taskList.innerHTML = saved;
            }
        }
        
        // 儲存任務
        function saveTasks() {
            localStorage.setItem('tasks', taskList.innerHTML);
        }
        
        // 新增任務
        taskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && taskInput.value.trim() !== '') {
                const li = document.createElement('li');
                li.textContent = taskInput.value;
                li.style.cursor = 'pointer';
                li.addEventListener('click', () => {
                    li.style.textDecoration = li.style.textDecoration === 'line-through' ? '' : 'line-through';
                    saveTasks();
                });
                taskList.appendChild(li);
                taskInput.value = '';
                saveTasks();
            }
        });
        
        // 點擊任務標記完成
        taskList.addEventListener('click', (e) => {
            if (e.target.tagName === 'LI') {
                e.target.style.textDecoration = 
                    e.target.style.textDecoration === 'line-through' ? '' : 'line-through';
                saveTasks();
            }
        });
        
        loadTasks();  // 頁面載入時讀取任務
    </script>
</body>
</html>
